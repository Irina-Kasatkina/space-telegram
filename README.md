# Загрузка в Telegram фотографий космоса

Этот проект представляет собой набор скриптов для скачивания с сервисов SpaceX и NASA фотографий космоса и загрузки их в Telegram:
- fetch_apod_nasa_images - получает <= 30 случайных фотографий Astronomy Pictures of the Day (APOD) с сайта NASA и сохраняет их на локальном компьютере;
- fetch_nasa_epic_images - получает 5 фотографий Земли Earth Polychromatic Imaging Camera (EPIC) с сайта NASA и сохраняет их на локальном компьютере;
- fetch_spacex_images - получает фотографии запуска ракеты с сайта SpaceX и сохраняет их на локальном компьютере;
- publish_image_in_telegram - публикует фотографию в telegram-канале с помощью telegram-бота;
- publish_all_images_in_telegram - публикует в telegram-канале все фотографии из папки с задержкой после публикации каждой фотографии.

## Установка

### Клонировать проект
Сделайте клонирование проекта:
```
git clone https://github.com/Irina-Kasatkina/web-api-space-telegram.git
```
или просто скопируйте все его файлы на ваш локальный диск.

### Настройка окружения

Для работы с утилитой у вас уже должен быть установлен Python 3.

Для управления зависимостями Python желательно воспользоваться [virtualenv](https://pypi.org/project/virtualenv/).

Установите пакеты с помощью `pip` (или `pip3`, есть конфликт с Python2):
```
pip install -r requirements.txt
```

### Переменные окружения

Для определения настроек окружения создайте файл `.env` в той же папке, где и скрипты, и запишите туда такие данные: 
```
#
IMAGES_DIRECTORY={путь_к_папке_с_фото}
NASA_API_KEY={ваш_API_KEY_сервиса_API_NASA}
TELEGRAM_BOT_TOKEN={API-токен_вашего_telegram-бота}
TELEGRAM_CHANNEL_ID={id_вашего_telegram-канала}
DELAY_IN_SECONDS={задержка_публикации_в_секундах}
```
Переменная окружения `IMAGE_FILES_DIRECTORY` нужна для работы любого из скриптов. Вместо `{путь_к_папке_с_фото}` подставьте абсолютный или относительный (относительно директории, из которой запускаются скрипты) путь к папке с фотографиями. Например: `./images`.

Переменная окружения `NASA_API_KEY` нужна для работы скриптов `fetch_apod_nasa_images` и `fetch_epic_nasa_images`. Вместо `{ваш_API_KEY_сервиса_API_NASA}` подставьте значение вашего `API KEY` с сервиса API NASA. Чтобы получить его, зарегистрируйтесь на сервисе [сайта NASA](https://api.nasa.gov/) и сгенерируйте там свой личный `API KEY` (там вы получите строку наподобие такой: `hg639e20ad155405123dk5677542fecf00231da7`).

Переменные окружения `TELEGRAM_BOT_TOKEN` и `TELEGRAM_CHANNEL_ID` нужны для работы скриптов `publish_image_in_telegram` и `publish_all_images_in_telegram`. 

Вместо `{API-токен_вашего_telegram-бота}` подставьте значение API-токена вашего telegram-бота, с помощью которого будет осуществляться публикация фотографий в telegram-канале. Если у вас ещё нет такого бота, [создайте его](https://way23.ru/регистрация-бота-в-telegram.html) - API-токен бота выглядит примерно так: `958423683:AAEAtJ5Lde5YYfkjergber`.

Вместо `{id_вашего_telegram-канала}` подставьте значение id telegram-канала, в котором будут публиковаться фотографии. Если у вас ещё нет такого канала, [создайте его и назначьте вашего telegram-бота администратором канала](https://smmplanner.com/blog/otlozhennyj-posting-v-telegram/) - id telegram-канала выглядит примерно так: `@flood_channel`.

Переменная окружения `DELAY_IN_SECONDS` нужна для работы скрипта `publish_all_images_in_telegram`. Если она задана, то скрипт будет делать публикацию каждой следующей фотографии через указанное количество секунд после публикации предыдущей фотографии. Если данный параметр не указан, то по умолчанию задержка будет 4 часа.

## Запуск

Для запуска нужного вам скрипта наберите в командной строке одну из команд:
```
python -m fetch_apod_nasa_images
python -m fetch_epic_nasa_images
python -m fetch_spacex_images [{id_конкретного_запуска}]
python -m publish_image_in_telegram [{имя_файла_с_фото}]
python -m publish_all_images_in_telegram
```
Здесь для скрипта `fetch_spacex_images` можно указать необязательный параметр `{id_конкретного_запуска}` - id конкретного запуска ракеты. Например: `5eb87d47ffd86e000604b38a`). Если этот параметр указан, то скрипт `fetch_spacex_images` получит фотографии указанного запуска. Если параметр не указан, то скрипт получит фотографии последнего из запусков, для которого имеются фотографии.

Для скрипта `publish_image_in_telegram` можно указать необязательный параметр `{имя_файла_с_фото}` - имя конкретного файла с фото, которое вы хотите опубликовать. Например: `image1.jpg`. Если этот параметр указан, то скрипт `publish_image_in_telegram` опубликует фото из файла с таким именем, лежащем в директории с картинками (заданным в переменной окружения `IMAGES_DIRECTORY` в файле `.env`). Если параметр `{имя_файла_с_фото}` не указан, то скрипт выберет в директории из `IMAGES_DIRECTORY` файл для публикации случайным образом.

### Цель проекта

Код написан в образовательных целях на онлайн-курсе для веб-разработчиков [dvmn.org](https://dvmn.org/).